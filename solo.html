<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text Interpreter</title>

	  <style>
		  /* ================================
		     Base Reset & Typography
		     ================================ */

		  body {
		      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
		      margin: 0;
		      padding: 2rem;
		      line-height: 1.6;
		  }

		  .better-markdown {
		      /* Prevent flash of unprocessed text */
		      visibility: hidden;
		      opacity: 0;
		      transition: opacity 0.3s ease-in;
		  }

		  /* ================================
		     Generated Content Styling
		     ================================ */

		  h1 {
		      margin-top: 0;
		      margin-bottom: 0.5rem;
		      font-weight: 600;
		  }

		  p {
		      margin-top: 0;
		      margin-bottom: 1rem;
		  }

		  /* ================================
		     Optional Enhancements (Safe)
		     ================================ */

		  /* Improve readability on very wide screens */
		  @media (min-width: 1200px) {
		      body {
		          max-width: 900px;
		          margin-left: auto;
		          margin-right: auto;
		      }
		  }

		  /* Slight smoothing for headers */
		  h1 {
		      letter-spacing: 0.02em;
		  }
	  </style>

    <!-- External interpreter script -->
    <script>
		document.addEventListener("DOMContentLoaded", function () {
	    // 1. Find all blocks that need interpreting
		    const markdownBlocks = document.querySelectorAll('.better-markdown');
    
		    let defaultColor = 'white';
		    let defaultBg = 'black';

		    // 2. Iterate through each block
		    markdownBlocks.forEach(block => {
		        const rawInput = block.textContent.trim();
		        const lines = rawInput.split('\n');
		        let htmlOutput = '';

		        // Check for configuration line (±) in this specific block
		        if (lines.length > 0 && lines[0].trim().startsWith('±')) {
		            const configLine = lines[0].trim();
		            const parts = configLine.split('|');

		            if (parts.length >= 3) {
		                defaultColor = parts[1].trim();
		                defaultBg = parts[2].trim();
		            }
		            lines.shift(); // Remove config line so it doesn't render
		        }

		        // 3. Process lines for this block
		        lines.forEach(line => {
		            const cleanLine = line.trim();
		            if (!cleanLine) return;
        
		            if (cleanLine.includes('# ')) {
		                const splitIndex = cleanLine.indexOf('# ');
		                const colorPart = cleanLine.substring(0, splitIndex).trim();
		                const text = cleanLine.substring(splitIndex + 2).trim();
		                const finalColor = colorPart === "" ? defaultColor : colorPart;
        
		                htmlOutput += `<h1 style="color: ${finalColor}">${text}</h1>`;
		            } else {
		                htmlOutput += `<p>${cleanLine}</p>`;
		            }
		        });

		        // 4. Swap the <p> for a <div> to accommodate <h1> elements
		        // (Valid HTML doesn't allow <h1> inside <p>)
		        const container = document.createElement('div');
		        container.className = 'interpreted-markdown';
		        container.innerHTML = htmlOutput;
		        block.parentNode.replaceChild(container, block);
		    });

		    // 5. Apply the global theme (from the last config found)
		    document.body.style.color = defaultColor;
		    document.body.style.backgroundColor = defaultBg;

		    // 6. Reveal the final page
		    document.body.style.visibility = 'visible';
		    document.body.style.opacity = '1';
		});
		</script>
</head>

<body>
    <div class="better-markdown">
        ±|white|black
        # This is a title
        green# This is my title
        
        this is my body text which inherits the default white color.
        
        red# Warning Section
        
        This text is normal body text again.
        
        orange# Another Header
    </div>
    
    <div style="border: 1px solid gray; padding: 10px; margin: 20px 0;">
            <strong>Note:</strong> This is a standard HTML box that the script will NOT change.
    </div>
        
    <div class="better-markdown">
        red# Warning Section
        This text is normal body text again.
    </div>    
</body>
</html>
